<!-- ----------------------------------------------------------
 Author: Nandan Kumar
 Date: 11/05/2025
 Assignment-10: Secure User Model, Pydantic Validation, and Docker Testing
 File: templates/index.html
 ----------------------------------------------------------
 Description:
 A clean, modern web interface for the FastAPI Calculator.
 Users can enter two numbers and perform arithmetic operations
 (Add, Subtract, Multiply, Divide). The result is processed by
 the FastAPI backend and displayed dynamically in the browser.
 Designed for integration testing within Docker Compose setup.
 ---------------------------------------------------------- -->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>FastAPI Calculator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    /* --------------------------------------------------------
       Basic Page Layout
       -------------------------------------------------------- */
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, #007bff, #00c6ff);
      color: #222;
    }

    /* --------------------------------------------------------
       Headings and Title Styles
       -------------------------------------------------------- */
    h1 {
      color: #ffffff;
      margin-bottom: 10px;
      text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.3);
    }

    h2 {
      color: #333333;
      margin-bottom: 15px;
    }

    /* --------------------------------------------------------
       Calculator Container
       -------------------------------------------------------- */
    .calculator {
      background-color: #ffffff;
      border-radius: 10px;
      padding: 30px 40px;
      box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
      max-width: 400px;
      width: 100%;
      transition: transform 0.2s ease;
    }

    .calculator:hover {
      transform: scale(1.02);
    }

    /* --------------------------------------------------------
       Input Fields
       -------------------------------------------------------- */
    input {
      margin: 8px;
      padding: 10px;
      width: 160px;
      text-align: center;
      border: 1px solid #ccc;
      border-radius: 5px;
      font-size: 15px;
      outline: none;
      transition: border 0.3s ease;
    }

    input:focus {
      border-color: #007bff;
    }

    /* --------------------------------------------------------
       Operation Buttons
       -------------------------------------------------------- */
    button {
      margin: 8px;
      padding: 8px 18px;
      font-size: 15px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      color: white;
      font-weight: bold;
      transition: all 0.3s ease;
    }

    /* Individual button colors */
    button#add { background-color: #28a745; }      /* Green */
    button#subtract { background-color: #f39c12; } /* Orange */
    button#multiply { background-color: #9b59b6; } /* Purple */
    button#divide { background-color: #dc3545; }   /* Red */

    button:hover {
      opacity: 0.9;
      transform: scale(1.05);
    }

    /* --------------------------------------------------------
       Result Display Box
       -------------------------------------------------------- */
    #result {
      margin-top: 20px;
      font-weight: bold;
      font-size: 18px;
      color: #333;
      background-color: #f7f7f7;
      padding: 10px;
      border-radius: 6px;
      min-height: 24px;
      box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
    }
  </style>
</head>

<body>
  <!-- Main Heading -->
  <h1>FastAPI Calculator</h1>

  <!-- Calculator Form -->
  <div class="calculator">
    <h2>Enter Two Numbers</h2>

    <!-- Number Inputs -->
    <input type="text" id="a" placeholder="First number">
    <input type="text" id="b" placeholder="Second number"><br>

    <!-- Operation Buttons -->
    <button id="add" onclick="calculate('add')">Add</button>
    <button id="subtract" onclick="calculate('subtract')">Subtract</button>
    <button id="multiply" onclick="calculate('multiply')">Multiply</button>
    <button id="divide" onclick="calculate('divide')">Divide</button>

    <!-- Display Area for Result -->
    <div id="result">Result will appear here</div>
  </div>

  <script>
    /**
     * ----------------------------------------------------------
     * Function: calculate(operation)
     * ----------------------------------------------------------
     * Sends a POST request to FastAPI with input numbers
     * and the selected arithmetic operation. Displays
     * the result or any error message dynamically.
     *
     * @param {string} operation - The name of the operation endpoint.
     * ----------------------------------------------------------
     */
    async function calculate(operation) {
      const a = document.getElementById('a').value.trim();
      const b = document.getElementById('b').value.trim();
      const resultBox = document.getElementById('result');

      // Basic input validation
      if (a === "" || b === "") {
        resultBox.innerText = "Error: Missing input values.";
        resultBox.style.color = "#dc3545";  // Red for error
        return;
      }

      try {
        // Send POST request to FastAPI endpoint
        const response = await fetch("/" + operation, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ a: parseFloat(a), b: parseFloat(b) })
        });

        // Parse JSON response
        const data = await response.json();

        // Handle success and error responses
        if (response.ok && data.result !== undefined) {
          resultBox.innerText = "Result: " + data.result;
          resultBox.style.color = "#28a745"; // Green for success
        } else {
          resultBox.innerText = "Error: " + (data.error || "Invalid input.");
          resultBox.style.color = "#dc3545";
        }

      } catch (error) {
        // Network or unexpected error
        resultBox.innerText = "Error: Unable to connect to server.";
        resultBox.style.color = "#dc3545";
      }
    }
  </script>
</body>
</html>
